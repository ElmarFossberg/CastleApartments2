{% extends 'base.html' %}

{% block content %}
<div class="apartment-detail-container">
    <h1 class="apartment-title">{{ apartment.address }}, {{ apartment.postal_code }} </h1>
    
    <div class="apartment-info-grid">
        <div class="apartment-image">
            <!-- Placeholder for image - in a real app you'd have an image field in your model -->
            <div class="image-placeholder">
            <img src="{{ images.0.image }}" alt="gerðueihherHugi" />
            </div>
        </div>
        
        <div class="apartment-details">
            <div class="detail-row">
                <span class="detail-label">Type:</span>
                <span class="detail-value">{{ apartment.type }}</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Price:</span>
                <span class="detail-value">{{ apartment.formatted_price }} kr.</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Size:</span>
                <span class="detail-value">{{ apartment.square_meters }} m²</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Rooms:</span>
                <span class="detail-value">{{ apartment.number_of_rooms }}</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Status:</span>
                <span class="detail-value {% if apartment.sold %}sold{% else %}available{% endif %}">
                    {% if apartment.sold %}Sold{% else %}Available{% endif %}
                </span>
            </div>
            
            <div class="detail-row full-width">
                <span class="detail-label">Address:</span>
                <span class="detail-value">{{ apartment.address }}, {{ apartment.postal_code }}</span>
            </div>
            <div class="full-width detail-row">
                <a class="button" href="javascript:history.back()">Go back</a>
                <!-- Check if the user is a buyer if so show the purchase offers -->
                {% if user_type == 'buyer' %}
                    <!-- Check if property is sold -->
                    {% if not apartment.sold %}
                       <!-- Check if user has submitted an offer (dynamic text)-->
                        {% if apartment.already_has_purchase_offer %}
                            <a class="button" href="/my-offers/create?apartment_id={{ apartment.id }}">Resubmit a purchase offer</a>
                        {% else %}
                            <a class="button" href="/my-offers/create?apartment_id={{ apartment.id }}">Submit a purchase offer</a>
                        {% endif %}
                    {% endif %}
                {% endif %}
                <form method="post" action="{% url 'favourite' %}">
                    {% csrf_token %}
                    <input type="hidden" name="apartment_id" value="{{ apartment.id }}">
                    {% if apartment.is_favourited %}
                        <button class="button" type="submit">Unfavourite</button>
                    {% else %}
                        <button class="button" type="submit" >Favourite</button>
                    {% endif %}
                </form>
            </div>
        </div>
    </div>
    
    <div class="apartment-description">
        <h2>Description</h2>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor.</p>
        <!-- In a real app, you'd have a description field in your model -->
    </div>
</div>
{% endblock %}
